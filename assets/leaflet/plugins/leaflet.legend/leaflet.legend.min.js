((t, e) => {
    "function" == typeof define && define.amd ? define([ "leaflet" ], t) : "object" == typeof exports && (module.exports = t(require("leaflet"))), 
    void 0 !== e && e.L && t(L);
})(function(n) {
    class t {
        constructor(t, e, i) {
            this._control = t, this._container = e, this._legend = i, this._width = this._control.options.symbolWidth, 
            this._height = this._control.options.symbolHeight;
        }
    }
    class e extends t {
        constructor(t, e, i) {
            super(t, e, i), this._canvas = this._buildCanvas(), this._drawSymbol && this._drawSymbol(), 
            this._style();
        }
        _buildCanvas() {
            var t = n.DomUtil.create("canvas", null, this._container);
            return t.height = this._control.options.symbolHeight, t.width = this._control.options.symbolWidth, 
            t;
        }
        _drawSymbol() {}
        _style() {
            var t = this._ctx = this._canvas.getContext("2d");
            (this._legend.fill || this._legend.fillColor) && (t.globalAlpha = this._legend.fillOpacity || 1, 
            t.fillStyle = this._legend.fillColor || this._legend.color, t.fill(this._legend.fillRule || "evenodd")), 
            (this._legend.stroke || this._legend.color) && (this._legend.dashArray && t.setLineDash(this._legend.dashArray || []), 
            t.globalAlpha = this._legend.opacity || 1, t.lineWidth = this._legend.weight || 2, 
            t.strokeStyle = this._legend.color || "#3388ff", t.lineCap = this._legend.lineCap || "round", 
            t.lineJoin = this._legend.lineJoin || "round", t.stroke());
        }
        rescale() {}
        center() {}
    }
    class l extends e {
        _drawSymbol() {
            var t = this._ctx = this._canvas.getContext("2d"), e = this._legend, i = e.weight || 3, s = this._control.options.symbolWidth / 2, l = this._control.options.symbolHeight / 2, i = Math.min(s, l) - i, n = i;
            e.radius && (n = Math.min(e.radius, i)), t.arc(s, l, n, 0, 2 * Math.PI, !1);
        }
    }
    class o extends e {
        _drawSymbol() {
            var t = this._ctx = this._canvas.getContext("2d"), e = this._control.options.symbolWidth, i = this._control.options.symbolHeight / 2;
            t.beginPath(), t.moveTo(0, i), t.lineTo(e, i);
        }
    }
    class h extends e {
        _drawSymbol() {
            var t = this._ctx = this._canvas.getContext("2d"), e = this._legend.weight || 3, i = this._control.options.symbolWidth / 2, s = this._control.options.symbolHeight / 2, l = i - e, e = s - e;
            l == e && (e /= 2), t.rect(i - l, s - e, 2 * l, 2 * e);
        }
    }
    class a extends e {
        _drawSymbol() {
            var t = this._ctx = this._canvas.getContext("2d"), e = this._legend.weight || 3, i = this._control.options.symbolWidth / 2, s = this._control.options.symbolHeight / 2, l = Math.min(i, s) - e, n = 360 / this._legend.sides;
            t.beginPath();
            for (var o = 0; o <= this._legend.sides; o++) {
                var h = i + l * Math.cos((n * o + (90 - n / 2)) * Math.PI / 180), a = s + l * Math.sin((n * o + (90 - n / 2)) * Math.PI / 180);
                0 == o ? t.moveTo(h, a) : t.lineTo(h, a);
            }
        }
    }
    class r extends t {
        constructor(t, e, i) {
            super(t, e, i), this._img = null, this._loadImages();
        }
        _loadImages() {
            var t = n.DomUtil.create("img", null, this._container);
            (this._img = t).onload = () => {
                this.rescale();
            }, t.src = this._legend.url;
        }
        rescale() {
            var t, e, i, s;
            this._img && (i = this._control.options, (this._img.width > i.symbolWidth || this._img.height > i.symbolHeight) && (t = this._img.width, 
            e = this._img.height, s = i.symbolWidth / t, i = i.symbolHeight / e, 
            s = Math.min(s, i), this._img.width = t * s, this._img.height = e * s), 
            this.center());
        }
        center() {
            var t = this._container.offsetWidth / 2, e = this._container.offsetHeight / 2, t = t - parseInt(this._img.width) / 2, e = e - parseInt(this._img.height) / 2;
            this._img.style.left = t.toString() + "px", this._img.style.top = e.toString() + "px";
        }
    }
    n.Control.Legend = n.Control.extend({
        options: {
            position: "topleft",
            title: "Legend",
            legends: [],
            symbolWidth: 24,
            symbolHeight: 24,
            opacity: 1,
            column: 1,
            collapsed: !1
        },
        initialize: function(t) {
            n.Util.setOptions(this, t), this._legendSymbols = [], this._buildContainer();
        },
        onAdd: function(t) {
            return this._map = t, this._initLayout(), this._container;
        },
        _buildContainer: function() {
            this._container = n.DomUtil.create("div", "leaflet-legend leaflet-bar leaflet-control"), 
            this._container.style.backgroundColor = "rgba(255,255,255, " + this.options.opacity + ")", 
            this._contents = n.DomUtil.create("section", "leaflet-legend-contents", this._container), 
            this._link = n.DomUtil.create("a", "leaflet-legend-toggle", this._container), 
            this._link.title = "Legend", this._link.href = "#";
            n.DomUtil.create("h3", "leaflet-legend-title", this._contents).innerText = this.options.title || "Legend";
            for (var t = this.options.legends.length, e = Math.ceil(t / this.options.column), i = this._contents, s = 0; s < t; s++) {
                s % e == 0 && (i = n.DomUtil.create("div", "leaflet-legend-column", this._contents));
                var l = this.options.legends[s];
                this._buildLegendItems(i, l);
            }
        },
        _buildLegendItems: function(t, e) {
            var i, s = n.DomUtil.create("div", "leaflet-legend-item", t), t = (e.inactive && n.DomUtil.addClass(s, "leaflet-legend-item-inactive"), 
            n.DomUtil.create("i", null, s));
            if ("image" === e.type) i = new r(this, t, e); else if ("circle" === e.type) i = new l(this, t, e); else if ("rectangle" === e.type) i = new h(this, t, e); else if ("polygon" === e.type) i = new a(this, t, e); else {
                if ("polyline" !== e.type) return void n.DomUtil.remove(s);
                i = new o(this, t, e);
            }
            this._legendSymbols.push(i), t.style.width = this.options.symbolWidth + "px", 
            t.style.height = this.options.symbolHeight + "px", n.DomUtil.create("span", null, s).innerText = e.label, 
            e.layers && (n.DomUtil.addClass(s, "leaflet-legend-item-clickable"), 
            n.DomEvent.on(s, "click", function() {
                this._toggleLegend.call(this, s, e.layers);
            }, this));
        },
        _initLayout: function() {
            n.DomEvent.disableClickPropagation(this._container), n.DomEvent.disableScrollPropagation(this._container), 
            this.options.collapsed ? (this._map.on("click", this.collapse, this), 
            n.DomEvent.on(this._container, {
                mouseenter: this.expand,
                mouseleave: this.collapse
            }, this)) : this.expand();
        },
        _toggleLegend: function(t, e) {
            if (n.DomUtil.hasClass(t, "leaflet-legend-item-inactive")) if (n.DomUtil.removeClass(t, "leaflet-legend-item-inactive"), 
            n.Util.isArray(e)) for (var i = 0, s = e.length; i < s; i++) this._map.addLayer(e[i]); else this._map.addLayer(e); else if (n.DomUtil.addClass(t, "leaflet-legend-item-inactive"), 
            n.Util.isArray(e)) for (i = 0, s = e.length; i < s; i++) this._map.removeLayer(e[i]); else this._map.removeLayer(e);
        },
        expand: function() {
            this._link.style.display = "none", n.DomUtil.addClass(this._container, "leaflet-legend-expanded");
            for (var t of this._legendSymbols) t.rescale();
            return this;
        },
        collapse: function() {
            return this._link.style.display = "block", n.DomUtil.removeClass(this._container, "leaflet-legend-expanded"), 
            this;
        },
        redraw: function() {
            n.DomUtil.empty(this._contents), this._buildLegendItems();
        }
    }), n.control.legend = n.control.Legend = function(t) {
        return new n.Control.Legend(t);
    };
}, window);